<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Composable Access Rule and Rule Executor - iris</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../../quickstart.html"><strong aria-hidden="true">2.</strong> Quickstart</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../quickstart/tech_overview.html"><strong aria-hidden="true">2.1.</strong> Technical Overview</a></li><li class="chapter-item expanded "><a href="../../quickstart/quick_setup.html"><strong aria-hidden="true">2.2.</strong> Quick setup guide</a></li><li class="chapter-item expanded "><a href="../../quickstart/data_ingestion.html"><strong aria-hidden="true">2.3.</strong> Data Ingestion</a></li><li class="chapter-item expanded "><a href="../../quickstart/data_ejection.html"><strong aria-hidden="true">2.4.</strong> Data Ejection</a></li></ol></li><li class="chapter-item expanded "><a href="../../developers.html"><strong aria-hidden="true">3.</strong> Developers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../developers/development_guide.html"><strong aria-hidden="true">3.1.</strong> Full Node Setup Guide</a></li><li class="chapter-item expanded "><a href="../../developers/nodes/ec2_setup.html"><strong aria-hidden="true">3.2.</strong> Configure a Hosted Node</a></li><li class="chapter-item expanded "><a href="../../quickstart/data_assets.html"><strong aria-hidden="true">3.3.</strong> Data Management</a></li><li class="chapter-item expanded "><a href="../../quickstart/data_spaces.html"><strong aria-hidden="true">3.4.</strong> Data Spaces</a></li><li class="chapter-item expanded "><a href="../../developers/contracts.html"><strong aria-hidden="true">3.5.</strong> Contracts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../developers/contracts/contracts_chain_extension.html"><strong aria-hidden="true">3.5.1.</strong> Chain Extension</a></li><li class="chapter-item expanded "><a href="../../developers/contracts/composable_access_rules.html" class="active"><strong aria-hidden="true">3.5.2.</strong> Composable Access Rule and Rule Executor</a></li><li class="chapter-item expanded "><a href="../../developers/contracts/contracts_asset_exchange.html"><strong aria-hidden="true">3.5.3.</strong> Iris Asset Exchange</a></li></ol></li><li class="chapter-item expanded "><a href="../../ui.html"><strong aria-hidden="true">3.6.</strong> Iris UI</a></li></ol></li><li class="chapter-item expanded "><a href="../../reference.html"><strong aria-hidden="true">4.</strong> Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../pallets.html"><strong aria-hidden="true">4.1.</strong> Pallets</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../pallets/pallet_data_assets.html"><strong aria-hidden="true">4.1.1.</strong> Data-Assets</a></li><li class="chapter-item expanded "><a href="../../pallets/pallet_authorities.html"><strong aria-hidden="true">4.1.2.</strong> Authorities</a></li><li class="chapter-item expanded "><a href="../../pallets/pallet_iris_ledger.html"><strong aria-hidden="true">4.1.3.</strong> Ledger</a></li><li class="chapter-item expanded "><a href="../../pallets/pallet_data_spaces.html"><strong aria-hidden="true">4.1.4.</strong> Data-Spaces</a></li><li class="chapter-item expanded "><a href="../../pallets/pallet_authorization.html"><strong aria-hidden="true">4.1.5.</strong> Authorization</a></li><li class="chapter-item expanded "><a href="../../pallets/pallet_proxy.html"><strong aria-hidden="true">4.1.6.</strong> Proxy</a></li><li class="chapter-item expanded "><a href="../../pallets/pallet_ipfs.html"><strong aria-hidden="true">4.1.7.</strong> IPFS</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../glossary.html"><strong aria-hidden="true">5.</strong> Glossary</a></li><li class="chapter-item expanded "><a href="../../contact.html"><strong aria-hidden="true">6.</strong> Contact</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">iris</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="composable-access-rules-and-rule-executors"><a class="header" href="#composable-access-rules-and-rule-executors">Composable Access Rules and Rule Executors</a></h1>
<p>A <strong>composable access rule</strong> is a smart contract that allows data owners to define and specify unique business models which are executed when a consumer nodes attempts to fetch it from the network. Composable access rules are executed within the context of a <strong>rule executor</strong> contract. In general, each composable access rule should be as small as possible and only check for one condition. The idea is that composable access rules can be deployed to the network and then used within many different rule executors (more on this below). Composable access rules are by no means the only way to write rules for your data and are just one potential, resuable approach that can be taken. </p>
<p>A <strong>rule executor</strong> allows a data owner to determine a unique collection of rules that shall be executed in order to provide authorization to data consumers to access their data. At a basic level, a rule executor makes cross contract calls to each composable access rule and then uses the <code>submit_execution_results</code> function exposed from our chain extension to report the results back on chain, which feeds into the locking mechanism managed by the <a href="../pallets/pallet_iris_ejection.html">iris-ejection pallet</a>. </p>
<h2 id="how-it-works"><a class="header" href="#how-it-works">How it works</a></h2>
<p>A rule exeuctor can theoretically be any contract that can make calls to the Iris runtime using the 'submit results' chain extension. The owner of a data asset class must register a rule executor contract address with their data through the 'Authorization' pallet after the exeuctor is deployed and their data asset class exists. This delegates rights to the rule executor to grant access to other nodes that meet the rules specified. That is, every rule exeuctor must call:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[ink::chain_extension]
pub trait Iris {
    type ErrorCode = CustomError;
    #[ink(extension = 4, returns_result = false)]
    fn submit_results(
        caller: ink_env::AccountId, 
        consumer: ink_env::AccountId, 
        asset_id: u32, 
        result: bool, 
        public_key: [u8;32],
    ) -&gt; [u8; 32];
} 
<span class="boring">}</span></code></pre></pre>
<p>and invoke the chain extension function:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span> self.env()
    .extension()
    .submit_results(
        contract_acct,
        caller.clone(),
        asset_id.clone(), 
        true,
        public_key.clone(),
    );
<span class="boring">}</span></code></pre></pre>
<p>And also be registered in the Authorization pallet.</p>
<h2 id="available-rules"><a class="header" href="#available-rules">Available Rules</a></h2>
<p>Composable Access Rules can be found in the <a href="https://github.com/ideal-lab5/contracts/tree/main/composable_access_rules">contracts</a> repository</p>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<p>See the examples folder of the github repo. </p>
<h4 id="trivial-rule-executor"><a class="header" href="#trivial-rule-executor">Trivial Rule Executor</a></h4>
<p>The trivial rule executor applies no rules. Basically, this means your data is free and open to anyone.</p>
<h4 id="limited-use-rule"><a class="header" href="#limited-use-rule">Limited Use Rule</a></h4>
<p>The limited use rule contract specifies some number of times N that a consumer can use their asset to access the data.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<p>For an example rule executor, take a look at the <a href="https://github.com/ideal-lab5/contracts/tree/main/composable_access_rules/rule_executor">contracts</a> repository.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../developers/contracts/contracts_chain_extension.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../developers/contracts/contracts_asset_exchange.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../developers/contracts/contracts_chain_extension.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../developers/contracts/contracts_asset_exchange.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
